One common task while troubleshooting ASA/FTD connections is to identify the connections with highest bytes count. 
Easiest way is to filter the connections using REGEX on device CLI.
ciscoasa# sh conn | ?   

  append    Append to file
  begin     Begin with the line that matches
  count     Count number of lines which match regexp
  exclude   Exclude lines that match
  grep      Include/exclude lines that match
  include   Include lines that match
  redirect  Redirect to file

For example following command shows all connections which have bytes count of minimum two digits.

ciscoasa# sh conn | grep (bytes .*..,)
UDP outside  185.125.190.56:123 inside  192.168.1.38:52247, idle 0:00:55, bytes 48, flags - 
TCP outside  208.90.58.6:443 inside  192.168.1.222:38940, idle 0:00:27, bytes 7297, flags UFRxIO 
UDP outside  185.125.190.58:123 inside  192.168.1.38:59754, idle 0:00:35, bytes 48, flags - 
UDP outside  91.189.91.157:123 inside  192.168.1.38:49357, idle 0:01:06, bytes 48, flags - 
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:02, bytes 1815578, flags UxIO 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:36269, idle 0:00:05, bytes 468661, flags UxIO 
UDP outside  185.125.190.57:123 inside  192.168.1.38:57734, idle 0:00:45, bytes 48, flags - 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 142503242, flags - 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:34791, idle 0:00:09, bytes 198211, flags UxIO 
TCP outside  10.56.224.241:61352 inside  192.168.1.38:22, idle 0:25:23, bytes 135371, flags UxIOB 

You can start from low value and move up by adding more . characters in regex


ciscoasa# sh conn | grep (bytes .*...,)
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:01, bytes 1816454, flags UxIO 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:36269, idle 0:00:03, bytes 478265, flags UxIO 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 142581070, flags - 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:34791, idle 0:00:02, bytes 199279, flags UxIO 
TCP outside  10.56.224.241:61352 inside  192.168.1.38:22, idle 0:26:55, bytes 135371, flags UxIOB 

ciscoasa# sh conn | grep (bytes .*....,)
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:03, bytes 1816508, flags UxIO 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:36269, idle 0:00:00, bytes 478447, flags UxIO 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 142584266, flags - 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:34791, idle 0:00:02, bytes 199509, flags UxIO 
TCP outside  10.56.224.241:61352 inside  192.168.1.38:22, idle 0:27:01, bytes 135371, flags UxIOB 

ciscoasa# sh conn | grep (bytes .*.....,)
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:00, bytes 1816562, flags UxIO 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:36269, idle 0:00:03, bytes 478571, flags UxIO 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 142586935, flags - 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:34791, idle 0:00:02, bytes 199551, flags UxIO 
TCP outside  10.56.224.241:61352 inside  192.168.1.38:22, idle 0:27:06, bytes 135371, flags UxIOB 

ciscoasa# sh conn | grep (bytes .*......,)
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:00, bytes 1816591, flags UxIO 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:36269, idle 0:00:00, bytes 478827, flags UxIO 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 142589763, flags - 
TCP outside  10.48.26.239:8305 inside  192.168.1.223:34791, idle 0:00:06, bytes 199551, flags UxIO 
TCP outside  10.56.224.241:61352 inside  192.168.1.38:22, idle 0:27:09, bytes 135371, flags UxIOB 

ciscoasa# sh conn | grep (bytes .*.......,)
TCP outside  18.196.119.79:443 inside  192.168.1.222:45818, idle 0:00:00, bytes 1816616, flags UxIO 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:01, bytes 142590451, flags - 


If you get lots of connections with same number of digits in bytes, you can use braceket expression on the first number to further isolate

e.g 
Filter with first digit between 5 and 9

ciscoasa# sh conn | grep (bytes [5-9]*.......,) 

Filter with first digit between 1 and 4

ciscoasa# sh conn | grep (bytes [1-4]*.......,)

Filter with first digit is 8 or 9

ciscoasa# sh conn | grep (bytes [89]*.......,)

few examples


ciscoasa# sh conn | grep (bytes [1-9]*........,)
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 145016668, flags - 
ciscoasa# sh conn | grep (bytes [9]*........,)  
ciscoasa# sh conn | grep (bytes [1]*........,)
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:01, bytes 145029371, flags - 
ciscoasa# sh conn | grep (bytes [1-5]*........,)
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 145045409, flags - 
ciscoasa# sh conn | grep (bytes [6-9]*........,)
ciscoasa# sh conn | grep (bytes [12]*........,) 
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:01, bytes 145050711, flags - 
ciscoasa# sh conn | grep (bytes [123]*........,)
UDP outside  10.0.1.135:514 inside  192.168.1.222:56219, idle 0:00:00, bytes 145062292, flags - 



You can apply similar logic on file as well. I am using a "sh conn" file with around 600k connections 

(base) RAJATSH-M-V7QW:Desktop rajatsh$ wc -l connu
  628849 connu
(base) RAJATSH-M-V7QW:Desktop rajatsh$ ls -lh connu
-rw-r--r--  1 rajatsh  staff    65M Oct 20 12:35 connu



***Masking the ip addresses in ouput

***Numeric sort on the column 9 which is bytes value, with default field seprator of blank space. Please note if your file has additional spaces, column value 
will be different.

base) RAJATSH-M-V7QW:Desktop rajatsh$ time grep "bytes .*.........," connu | sort -nrk9 | head -30
TCP internet  x.x.x.x:52423 outside  x.x.x.x:8305, idle 0:37:51, bytes 234329823085, flags UIOoN1
TCP internet  x.x.x.x:34113 outside  x.x.x.x:8305, idle 0:38:09, bytes 210493179767, flags UIO N1
TCP internet  x.x.x.x:36580 outside  x.x.x.x:443, idle 0:00:00, bytes 15847987764, flags UIOoN1
TCP internet  x.x.x.x:52376 outside  x.x.x.x:443, idle 0:00:00, bytes 14810575645, flags UIOoN1
TCP internet  x.x.x.x:44424 outside  x.x.x.x:443, idle 0:00:00, bytes 12760598833, flags UIOoN1
TCP internet  x.x.x.x:40032 outside  x.x.x.x:443, idle 0:00:00, bytes 11037655427, flags UIOoN1
TCP internet  x.x.x.x:46510 outside  x.x.x.x:443, idle 0:00:00, bytes 7913673073, flags UIOoN1
TCP internet  x.x.x.x:10001 outside  x.x.x.x:36136, idle 0:00:00, bytes 6876346568, flags UIO N1
TCP internet  x.x.x.x:41674 outside  x.x.x.x:443, idle 0:17:54, bytes 6824429435, flags UIOoN1
UDP internet  x.x.x.x:55030 outside  x.x.x.x:59872, idle 0:00:00, bytes 6124057215, flags - N1
TCP internet  x.x.x.x:46446 outside  x.x.x.x:443, idle 0:00:01, bytes 6113582214, flags UIOoN1
TCP internet  x.x.x.x:8000 outside  x.x.x.x:60752, idle 0:00:00, bytes 5734013551, flags UIO N1
TCP internet  x.x.x.x:35374 outside  x.x.x.x:443, idle 0:00:04, bytes 4630486373, flags UIOoN1
TCP internet  x.x.x.x:10201 outside  x.x.x.x:52302, idle 0:00:00, bytes 4463234926, flags UIO N1
UDP internet  x.x.x.x:54512 outside  x.x.x.x:48078, idle 0:00:00, bytes 4324907121, flags - N1
TCP internet  x.x.x.x:19219 outside  x.x.x.x:443, idle 0:00:00, bytes 4306351549, flags UIOoN1
TCP internet  x.x.x.x:52912 outside  x.x.x.x:443, idle 0:00:00, bytes 4248417202, flags UIOoN1
TCP internet  x.x.x.x:443 outside  x.x.x.x:59700, idle 0:00:00, bytes 4166659235, flags UOo
TCP internet  x.x.x.x:443 outside  x.x.x.x:44570, idle 0:00:22, bytes 4064883107, flags UIOo
TCP internet  x.x.x.x:443 outside  x.x.x.x:16299, idle 0:00:00, bytes 3900868072, flags UIOo
TCP internet  x.x.x.x:56789 outside  x.x.x.x:443, idle 0:00:00, bytes 3889361205, flags UIOoN1
TCP internet  x.x.x.x:443 outside  x.x.x.x:25117, idle 0:00:00, bytes 3811128475, flags UOo
TCP internet  x.x.x.x:23138 outside  x.x.x.x:443, idle 0:00:00, bytes 3721076954, flags UIOoN1
TCP internet  x.x.x.x:36832 outside  x.x.x.x:443, idle 0:00:00, bytes 3611308750, flags UIOoN1
TCP internet  x.x.x.x:52472 outside  x.x.x.x:443, idle 0:00:00, bytes 3605029000, flags UIOoN1
TCP internet  x.x.x.x:57060 outside  x.x.x.x:443, idle 0:00:04, bytes 3405916155, flags UIOoN1
TCP internet  x.x.x.x:46312 outside  x.x.x.x:443, idle 0:00:00, bytes 3343244422, flags UIOoN1
TCP internet  x.x.x.x:443 outside  x.x.x.x:3327, idle 0:00:01, bytes 3291889440, flags UOo
TCP internet  x.x.x.x:5044 outside  x.x.x.x:45068, idle 0:00:10, bytes 3001475756, flags UIOoN1
UDP internet  x.x.x.x:3480 outside  x.x.x.x:50034, idle 0:00:00, bytes 2978517854, flags -o

real	0m1.643s
user	0m1.461s
sys	0m0.034s



If you have large values to sort, it will be good idea to use regex to filter out unwanted values as sort memory usage will grow with file size.

example for around 4Gbytes file

-rw-r--r--@  1 rajatsh  staff   4.0G Sep 10 23:37 conn2

39 million connections

(base) RAJATSH-M-V7QW:Desktop rajatsh$ wc -l conn2
 39398150 conn2


It took 26 minute with 8Gbytes of memory usage.

 time  sort -nrk9  conn2  | head -30

real	26m3.030s
user	4m37.467s
sys	15m23.332s






